#!/usr/bin/perl

$nevent = 0;
$neventpt = 0;
$neventtot = 0;
$sumcer = 0; $sumcer2 = 0.;
$sumcoll = 0; $sumcoll2 = 0;
$sumacc = 0; $sumacc2 = 0;
$sumpe = 0; $sumpe2 = 0;

$npe = 0;
while (<>) {
    chomp;
    if ($_ =~ m/^\*\*\* Killing Photon P = ([\d\.\-]+) ([\d\.\-]+) ([\d\.\-]+) mm T = ([\d\.]+) ns E = ([\d\.]+) eV \*\*\*$/) {

	$x = $1;
	$y = $2;
	$z = $3;
	$t = $4;
	$e = $5;
	if (rand()<quantum_eff($e)) { $npe++; }

    }
    if ($_ =~ m/^OpNoviceEventAction - Event (\d+) Edep ([\d.]+) MeV NPMT (\d+) NScint (\d+) NCerenkov (\d+)$/) {

	$neventtot++;
	    
	$event = $1;
	$etot = $2;
	$npmt = $3;
	$nsci = $4;
	$ncer = $5;

	if ($ncer>0) {

	    $nevent++;

	    printf "Event %3d N gamma Cerenkov %5d PMT %4d (%4.1f\%) Ph.el. %4d (%4.1f\%)\n"
		,$event,$ncer,$npmt,100.*$npmt/$ncer,$npe,100.*$npe/$ncer;
	    $sumcer += $ncer;
	    $sumcer2 += $ncer*$ncer;
	    $sumacc += $npmt;
	    $sumacc2 += $npmt*$npmt;
	    $sumpe += $npe;
	    $sumpe2 += $npe*$npe;

	} else {

	    $neventpt++;

	    printf "Event %3d Punch through %d\n",$event,$neventpt;

	}

	$npe = 0;

    }

}

printf "Total events %d Punch through %d (%4.1f\%)\n",$neventtot,$neventpt,100.*$neventpt/$neventtot;
printf "Cerenkov %6.1f %6.1f\n",$sumcer/$nevent,sqrt(($sumcer2-$sumcer*$sumcer/$nevent)/($nevent-1));
printf "Accepted %6.1f %6.1f\n",$sumacc/$nevent,sqrt(($sumacc2-$sumacc*$sumacc/$nevent)/($nevent-1));
printf "Ph.elec. %6.1f %6.1f\n",$sumpe/$nevent,sqrt(($sumpe2-$sumpe*$sumpe/$nevent)/($nevent-1));

sub quantum_eff {

    my ($e) = @_;

# Legenda: @ep = photon energies, @qe = quantum efficiencies

# Standard R13478 PMT

#    @ep = (
#	1.7442, 1.7528, 1.7673, 1.7791, 1.7910, 1.8061, 1.8184, 1.8308,
#	1.8466, 1.8594, 1.8724, 1.8889, 1.9023, 1.9159, 1.9332, 1.9472,
#	1.9615, 1.9759, 1.9943, 2.0092, 2.0244, 2.0437, 2.0594, 2.0753,
#	2.0956, 2.1121, 2.1288, 2.1502, 2.1675, 2.1852, 2.2077, 2.2260,
#	2.2446, 2.2683, 2.2877, 2.3073, 2.3324, 2.3528, 2.3736, 2.4002,
#	2.4218, 2.4439, 2.4720, 2.4950, 2.5184, 2.5483, 2.5727, 2.5976,
#	2.6293, 2.6553, 2.6819, 2.7158, 2.7435, 2.7718, 2.8081, 2.8377,
#	2.8680, 2.9068, 2.9386, 2.9711, 3.0128, 3.0470, 3.0819, 3.1268,
#	3.1636, 3.2013, 3.2497, 3.2895, 3.3303, 3.3827, 3.4258, 3.4700,
#	3.5269, 3.5738, 3.6220, 3.6840, 3.7352, 3.7878, 3.8556, 3.9116,
#	3.9693, 4.0436, 4.1051, 4.1838 );
#    
#    @qe = (
#	0.0002, 0.0002, 0.0004, 0.0005, 0.0007, 0.0010, 0.0013, 0.0017,
#	0.0023, 0.0029, 0.0035, 0.0046, 0.0054, 0.0066, 0.0081, 0.0094,
#	0.0112, 0.0130, 0.0153, 0.0178, 0.0198, 0.0234, 0.0268, 0.0295,
#	0.0342, 0.0376, 0.0425, 0.0468, 0.0522, 0.0574, 0.0631, 0.0676,
#	0.0743, 0.0817, 0.0875, 0.0937, 0.1003, 0.1088, 0.1164, 0.1246,
#	0.1316, 0.1390, 0.1468, 0.1529, 0.1614, 0.1705, 0.1776, 0.1800,
#	0.1901, 0.1927, 0.2007, 0.2062, 0.2119, 0.2148, 0.2208, 0.2238,
#	0.2300, 0.2331, 0.2363, 0.2363, 0.2395, 0.2395, 0.2428, 0.2428,
#	0.2428, 0.2428, 0.2395, 0.2395, 0.2363, 0.2300, 0.2269, 0.2148,
#	0.2062, 0.2035, 0.1927, 0.1728, 0.1636, 0.1448, 0.1230, 0.1044,
#	0.0851, 0.0590, 0.0381, 0.0094 );

# UV-extended R13478 PMT (E.Leonardi with DataThief)

@ep = (
      1.788611, 1.788666, 1.810196, 1.831930, 1.853982, 1.875842, 1.898307, 1.921391, 1.944106, 1.967089,
      1.990465, 2.013935, 2.037682, 2.061709, 2.086083, 2.110873, 2.135828, 2.160947, 2.186427, 2.212141,
      2.238157, 2.264548, 2.291250, 2.318126, 2.345317, 2.372828, 2.400661, 2.428821, 2.457310, 2.486134,
      2.515296, 2.544801, 2.574651, 2.604851, 2.635326, 2.666238, 2.697431, 2.728989, 2.761000, 2.793301,
      2.825980, 2.859129, 2.892578, 2.960655, 2.995293, 3.030336, 3.065788, 3.101561, 3.137846, 3.174558,
      3.211696, 3.249271, 3.287285, 3.325743, 3.403912, 3.443735, 3.483917, 3.524677, 3.565804, 3.649615,
      3.692089, 3.735169, 3.822962, 3.867569, 3.912818, 4.004784, 4.051515, 4.146742, 4.195128, 4.293602,
      4.343832, 4.445930, 4.497807, 4.603385, 4.657241, 4.766560, 4.878594, 4.935520, 5.051527, 5.170256,
      5.291779, 5.415993, 5.479192, 5.607973, 5.739609, 5.874335, 6.082378, 6.225150, 6.371080, 6.520033,
      6.749304 );

@qe = (
      0.000372, 0.000391, 0.000671, 0.001099, 0.001888, 0.002206, 0.003442, 0.007168, 0.008792, 0.010783,
      0.014561, 0.017019, 0.019893, 0.023251, 0.028517, 0.038508, 0.047230, 0.052610, 0.061492, 0.068497,
      0.076301, 0.089183, 0.104240, 0.110659, 0.117474, 0.124708, 0.132387, 0.140539, 0.149193, 0.158381,
      0.168133, 0.178487, 0.189478, 0.201146, 0.203499, 0.216031, 0.218558, 0.221115, 0.234731, 0.237477,
      0.240255, 0.255050, 0.258034, 0.264107, 0.267197, 0.270323, 0.273485, 0.263684, 0.266769, 0.269890,
      0.273048, 0.276242, 0.279474, 0.282743, 0.275800, 0.279027, 0.269027, 0.272175, 0.262421, 0.255976,
      0.235207, 0.226777, 0.221209, 0.213281, 0.215776, 0.210477, 0.202935, 0.197951, 0.190857, 0.177423,
      0.179498, 0.175090, 0.168816, 0.156933, 0.158769, 0.147593, 0.143969, 0.138810, 0.135401, 0.132076,
      0.128832, 0.119764, 0.115472, 0.112636, 0.104707, 0.097337, 0.087243, 0.081102, 0.071851, 0.057814,
      0.035260 );

# UV-extended R13478 PMT (M.Raggi with DataThief)

#@ep = (
#      1.788178, 1.788217, 1.788255, 1.795437, 1.795476, 1.795514, 1.795553, 1.795591, 1.795630, 1.795668,
#      1.795707, 1.802919, 1.802958, 1.802996, 1.803035, 1.803074, 1.803112, 1.803151, 1.803190, 1.803229,
#      1.810471, 1.810510, 1.810549, 1.810587, 1.810626, 1.810665, 1.810704, 1.810743, 1.810782, 1.818054,
#      1.818093, 1.818132, 1.818171, 1.818211, 1.818250, 1.818289, 1.818328, 1.818367, 1.818406, 1.818445,
#      1.818484, 1.818523, 1.825787, 1.825826, 1.825866, 1.825905, 1.825944, 1.825983, 1.826023, 1.826062,
#      1.826101, 1.826140, 1.826179, 1.826219, 1.833514, 1.833553, 1.833592, 1.833632, 1.833671, 1.833711,
#      1.833750, 1.833789, 1.833829, 1.833868, 1.841194, 1.841233, 1.841273, 1.841312, 1.841352, 1.841392,
#      1.841431, 1.841471, 1.848866, 1.848906, 1.848946, 1.848985, 1.849025, 1.849065, 1.849105, 1.856531,
#      1.856571, 1.856611, 1.856651, 1.856690, 1.856730, 1.856770, 1.856810, 1.864267, 1.864308, 1.864348,
#      1.864388, 1.864428, 1.864468, 1.864508, 1.871996, 1.872036, 1.872076, 1.872117, 1.872157, 1.872197,
#      1.872237, 1.879757, 1.879797, 1.872358, 1.879878, 1.879918, 1.879958, 1.879999, 1.880039, 1.887590,
#      1.887630, 1.887671, 1.887711, 1.887752, 1.887792, 1.887833, 1.887874, 1.895456, 1.895496, 1.895537,
#      1.895578, 1.895618, 1.895659, 1.895700, 1.895741, 1.895781, 1.895822, 1.895863, 1.903436, 1.903477,
#      1.903518, 1.903559, 1.903600, 1.903640, 1.911286, 1.911327, 1.911368, 1.911409, 1.911450, 1.911491,
#      1.911532, 1.911573, 1.911614, 1.911655, 1.911696, 1.919333, 1.919374, 1.919415, 1.919457, 1.919498,
#      1.919539, 1.919580, 1.919621, 1.927331, 1.927372, 1.927414, 1.927455, 1.927497, 1.935238, 1.935280,
#      1.935321, 1.935363, 1.935404, 1.935446, 1.935487, 1.935529, 1.943302, 1.943344, 1.943386, 1.943428,
#      1.943469, 1.943511, 1.943553, 1.951359, 1.951400, 1.951442, 1.951484, 1.951526, 1.951568, 1.951610,
#      1.959448, 1.959490, 1.959532, 1.959574, 1.959616, 1.959658, 1.959701, 1.967571, 1.967613, 1.967656,
#      1.967698, 1.967740, 1.975643, 1.975685, 1.975728, 1.975770, 1.983705, 1.983748, 1.983791, 1.983833,
#      1.983876, 1.991844, 1.991886, 1.991929, 1.991972, 1.999972, 2.000015, 2.000058, 2.000101, 2.000144,
#      2.008177, 2.008220, 2.008263, 2.016329, 2.016372, 2.024470, 2.024514, 2.024557, 2.024601, 2.024644,
#      2.024688, 2.024731, 2.024775, 2.032907, 2.032950, 2.032994, 2.033038, 2.041203, 2.041247, 2.041290,
#      2.041334, 2.049533, 2.049577, 2.049621, 2.049665, 2.049709, 2.057941, 2.057985, 2.058029, 2.066295,
#      2.066339, 2.066384, 2.066428, 2.074727, 2.074772, 2.074816, 2.074861, 2.074905, 2.083239, 2.083283,
#      2.083328, 2.083373, 2.091740, 2.091785, 2.091830, 2.091875, 2.100276, 2.100322, 2.100367, 2.100412,
#      2.108847, 2.108893, 2.108938, 2.117408, 2.117454, 2.117499, 2.126003, 2.126049, 2.126095, 2.134634,
#      2.134679, 2.134725, 2.134771, 2.143345, 2.143391, 2.143437, 2.152045, 2.152092, 2.152138, 2.160781,
#      2.160828, 2.169506, 2.169553, 2.169599, 2.178313, 2.178360, 2.178406, 2.187155, 2.187202, 2.187249,
#      2.196034, 2.196081, 2.196128, 2.204948, 2.213804, 2.213851, 2.213899, 2.222791, 2.222838, 2.231766,
#      2.231814, 2.240777, 2.240825, 2.249825, 2.249873, 2.258909, 2.258958, 2.268030, 2.268079, 2.277188,
#      2.277237, 2.286383, 2.295566, 2.295615, 2.304835, 2.314091, 2.314141, 2.323435, 2.332767, 2.332817,
#      2.342186, 2.342236, 2.351593, 2.351643, 2.361088, 2.370571, 2.380091, 2.389650, 2.389702, 2.399299,
#      2.408935, 2.418610, 2.428324, 2.428376, 2.438129, 2.447921, 2.457753, 2.467624, 2.477534, 2.487484,
#      2.487538, 2.497475, 2.507505, 2.517576, 2.527687, 2.527741, 2.537893, 2.548032, 2.558265, 2.568484,
#      2.578800, 2.589157, 2.599556, 2.609940, 2.620422, 2.630947, 2.641513, 2.652065, 2.662659, 2.673353,
#      2.684032, 2.694812, 2.705577, 2.716443, 2.727294, 2.738189, 2.749186, 2.760168, 2.771194, 2.782324,
#      2.793439, 2.804598, 2.815861, 2.827110, 2.838403, 2.849742, 2.861126, 2.872617, 2.884092, 2.895613,
#      2.907180, 2.918793, 2.930453, 2.942159, 2.953912, 2.965712, 2.977559, 2.989453, 3.001395, 3.013385,
#      3.025422, 3.037508, 3.049642, 3.061824, 3.074055, 3.086335, 3.098664, 3.111042, 3.123470, 3.135947,
#      3.148474, 3.160983, 3.173610, 3.186288, 3.199016, 3.211795, 3.224625, 3.237437, 3.250369, 3.263284,
#      3.276319, 3.289407, 3.302476, 3.315669, 3.328914, 3.342212, 3.355491, 3.368895, 3.382353, 3.395791,
#      3.409356, 3.422975, 3.436575, 3.450303, 3.464086, 3.477924, 3.491742, 3.505690, 3.519619, 3.533679,
#      3.547795, 3.547719, 3.561891, 3.576042, 3.590250, 3.604592, 3.618914, 3.633370, 3.647806, 3.662378,
#      3.676929, 3.691617, 3.706284, 3.721090, 3.721010, 3.735874, 3.750717, 3.765619, 3.780580, 3.780499,
#      3.795520, 3.810599, 3.825739, 3.840940, 3.856283, 3.871604, 3.887070, 3.902514, 3.918019, 3.933670,
#      3.949299, 3.965076, 3.980915, 3.996817, 3.996731, 4.012697, 4.028640, 4.044646, 4.060716, 4.076937,
#      4.093223, 4.109486, 4.125902, 4.142295, 4.142206, 4.158664, 4.175276, 4.191865, 4.208520, 4.225241,
#      4.242028, 4.258973, 4.275987, 4.293068, 4.292976, 4.310032, 4.309940, 4.327064, 4.344256, 4.361516,
#      4.378845, 4.396242, 4.413709, 4.431245, 4.448851, 4.466623, 4.484369, 4.502186, 4.520074, 4.538130,
#      4.556161, 4.574263, 4.592437, 4.610782, 4.629201, 4.647593, 4.666159, 4.684698, 4.703412, 4.703311,
#      4.722099, 4.740861, 4.740759, 4.759697, 4.778608, 4.797696, 4.816758, 4.835896, 4.855214, 4.874504,
#      4.874399, 4.893871, 4.913315, 4.932836, 4.952541, 4.972325, 4.992081, 5.012022, 5.031936, 5.052037,
#      5.051928, 5.072109, 5.092261, 5.112603, 5.132916, 5.153310, 5.173785, 5.194341, 5.214978, 5.235810,
#      5.256613, 5.256500, 5.277498, 5.298466, 5.319632, 5.340767, 5.361987, 5.383406, 5.404795, 5.404679,
#      5.426269, 5.447828, 5.447711, 5.469356, 5.491204, 5.513140, 5.535044, 5.557155, 5.579234, 5.601401,
#      5.623656, 5.645999, 5.668432, 5.690953, 5.713564, 5.736264, 5.759055, 5.781937, 5.804909, 5.828098,
#      5.851254, 5.874501, 5.897841, 5.921274, 5.944928, 5.968548, 5.968419, 5.992261, 6.016069, 6.039972,
#      6.063969, 6.063839, 6.088062, 6.112251, 6.112120, 6.136404, 6.160917, 6.160785, 6.185262, 6.185129,
#      6.184997, 6.209570, 6.209437, 6.234242, 6.259011, 6.258877, 6.283744, 6.308846, 6.308710, 6.333776,
#      6.333639, 6.358804, 6.358667, 6.358530, 6.358394, 6.383656, 6.409019, 6.408882, 6.434345, 6.434207,
#      6.459910, 6.459771, 6.459633, 6.485297, 6.485158, 6.510925, 6.510784, 6.536652, 6.536512, 6.536372,
#      6.536231, 6.562201, 6.562060, 6.588132, 6.587990, 6.587849, 6.587707, 6.613881, 6.613739, 6.613597,
#      6.613455, 6.639874, 6.639731, 6.639588, 6.639446, 6.639303, 6.639161, 6.639018, 6.638876, 6.665252,
#      6.665110, 6.664967, 6.664823 );
#
#@qe = (
#      0.000437, 0.000444, 0.000451, 0.000461, 0.000468, 0.000476, 0.000484, 0.000492, 0.000501, 0.000509,
#      0.000517, 0.000528, 0.000537, 0.000546, 0.000555, 0.000564, 0.000574, 0.000583, 0.000593, 0.000603,
#      0.000615, 0.000626, 0.000636, 0.000647, 0.000658, 0.000669, 0.000680, 0.000691, 0.000703, 0.000717,
#      0.000729, 0.000741, 0.000754, 0.000766, 0.000779, 0.000792, 0.000805, 0.000819, 0.000832, 0.000846,
#      0.000861, 0.000875, 0.000878, 0.000893, 0.000908, 0.000923, 0.000939, 0.000954, 0.000970, 0.000986,
#      0.001003, 0.001020, 0.001037, 0.001054, 0.001058, 0.001076, 0.001094, 0.001112, 0.001130, 0.001149,
#      0.001169, 0.001188, 0.001208, 0.001228, 0.001233, 0.001254, 0.001274, 0.001296, 0.001317, 0.001339,
#      0.001362, 0.001384, 0.001413, 0.001437, 0.001461, 0.001485, 0.001510, 0.001535, 0.001561, 0.001593,
#      0.001620, 0.001647, 0.001674, 0.001702, 0.001731, 0.001760, 0.001789, 0.001826, 0.001857, 0.001888,
#      0.001919, 0.001951, 0.001984, 0.002017, 0.002059, 0.002093, 0.002128, 0.002164, 0.002200, 0.002236,
#      0.002274, 0.002321, 0.002360, 0.002390, 0.002439, 0.002480, 0.002521, 0.002563, 0.002606, 0.002660,
#      0.002705, 0.002750, 0.002796, 0.002842, 0.002890, 0.002938, 0.002987, 0.003049, 0.003100, 0.003152,
#      0.003204, 0.003258, 0.003312, 0.003368, 0.003424, 0.003481, 0.003539, 0.003598, 0.003613, 0.003673,
#      0.003734, 0.003797, 0.003860, 0.003924, 0.004006, 0.004073, 0.004141, 0.004210, 0.004280, 0.004352,
#      0.004424, 0.004498, 0.004573, 0.004649, 0.004727, 0.004746, 0.004825, 0.004906, 0.004988, 0.005071,
#      0.005156, 0.005242, 0.005329, 0.005440, 0.005531, 0.005623, 0.005717, 0.005812, 0.005933, 0.006032,
#      0.006133, 0.006235, 0.006339, 0.006445, 0.006553, 0.006662, 0.006800, 0.006914, 0.007029, 0.007147,
#      0.007266, 0.007387, 0.007511, 0.007666, 0.007794, 0.007925, 0.008057, 0.008191, 0.008328, 0.008467,
#      0.008643, 0.008787, 0.008934, 0.009083, 0.009235, 0.009389, 0.009546, 0.009744, 0.009906, 0.010072,
#      0.010240, 0.010411, 0.010627, 0.010804, 0.010985, 0.011168, 0.011400, 0.011590, 0.011784, 0.011980,
#      0.012181, 0.012433, 0.012641, 0.012852, 0.013066, 0.013338, 0.013560, 0.013787, 0.014017, 0.014251,
#      0.014547, 0.014790, 0.015037, 0.015349, 0.015605, 0.015929, 0.016195, 0.016465, 0.016740, 0.017019,
#      0.017304, 0.017592, 0.017886, 0.018257, 0.018562, 0.018872, 0.019187, 0.019585, 0.019912, 0.020245,
#      0.020583, 0.021010, 0.021361, 0.021717, 0.022080, 0.022449, 0.022915, 0.023297, 0.023686, 0.024178,
#      0.024581, 0.024992, 0.025409, 0.025936, 0.026369, 0.026810, 0.027257, 0.027712, 0.028287, 0.028760,
#      0.029240, 0.029728, 0.030345, 0.030852, 0.031367, 0.031890, 0.032552, 0.033096, 0.033648, 0.034210,
#      0.034920, 0.035503, 0.036096, 0.036845, 0.037460, 0.038086, 0.038876, 0.039525, 0.040185, 0.041019,
#      0.041704, 0.042400, 0.043108, 0.044003, 0.044737, 0.045484, 0.046428, 0.047203, 0.047992, 0.048988,
#      0.049806, 0.050839, 0.051688, 0.052551, 0.053642, 0.054537, 0.055448, 0.056599, 0.057544, 0.058504,
#      0.059719, 0.060716, 0.061729, 0.063010, 0.064318, 0.065392, 0.066484, 0.067864, 0.068997, 0.070429,
#      0.071605, 0.073091, 0.074311, 0.075854, 0.077120, 0.078721, 0.080035, 0.081696, 0.083060, 0.084784,
#      0.086200, 0.087989, 0.089815, 0.091315, 0.093210, 0.095145, 0.096733, 0.098741, 0.100790, 0.102473,
#      0.104600, 0.106346, 0.106771, 0.108554, 0.110807, 0.113107, 0.115454, 0.117851, 0.119818, 0.122305,
#      0.124844, 0.127435, 0.130080, 0.132252, 0.134997, 0.137799, 0.140659, 0.143579, 0.146559, 0.149601,
#      0.152099, 0.152706, 0.155876, 0.159111, 0.162414, 0.165125, 0.168553, 0.169226, 0.172738, 0.173428,
#      0.177028, 0.180703, 0.184453, 0.185190, 0.189034, 0.192958, 0.196963, 0.197750, 0.198540, 0.202660,
#      0.203470, 0.207693, 0.208523, 0.212851, 0.213701, 0.214555, 0.219008, 0.219883, 0.220762, 0.225344,
#      0.226244, 0.227148, 0.231863, 0.232789, 0.233719, 0.234652, 0.235590, 0.240480, 0.241440, 0.242405,
#      0.243373, 0.244345, 0.245321, 0.246301, 0.247285, 0.248273, 0.249265, 0.250261, 0.251260, 0.252264,
#      0.253272, 0.254283, 0.255299, 0.256319, 0.257343, 0.258371, 0.259403, 0.260439, 0.261480, 0.262524,
#      0.263573, 0.260280, 0.261320, 0.262364, 0.263412, 0.264464, 0.265521, 0.262204, 0.263251, 0.259963,
#      0.261001, 0.262044, 0.258771, 0.259804, 0.260842, 0.261884, 0.258613, 0.259646, 0.260683, 0.257427,
#      0.258455, 0.259488, 0.256246, 0.257270, 0.258297, 0.259329, 0.256090, 0.257113, 0.253901, 0.254915,
#      0.255934, 0.251731, 0.252737, 0.249579, 0.246462, 0.247446, 0.244355, 0.245331, 0.242267, 0.243235,
#      0.240196, 0.241156, 0.238143, 0.239095, 0.235168, 0.236108, 0.233158, 0.230246, 0.227370, 0.223636,
#      0.220843, 0.218084, 0.215360, 0.212669, 0.213519, 0.210852, 0.211694, 0.209050, 0.206438, 0.207263,
#      0.204674, 0.205491, 0.206312, 0.207136, 0.203735, 0.204549, 0.201994, 0.199471, 0.196979, 0.197766,
#      0.198556, 0.196075, 0.196859, 0.194400, 0.191207, 0.188819, 0.189573, 0.187205, 0.184867, 0.182557,
#      0.180277, 0.180997, 0.181720, 0.182446, 0.179450, 0.177208, 0.174298, 0.172121, 0.169971, 0.167848,
#      0.165751, 0.163681, 0.161636, 0.159617, 0.157623, 0.158253, 0.156276, 0.154324, 0.152396, 0.153005,
#      0.151093, 0.149206, 0.147342, 0.147931, 0.148522, 0.146666, 0.147252, 0.145413, 0.145994, 0.143596,
#      0.144170, 0.142369, 0.140031, 0.140591, 0.138834, 0.139389, 0.137648, 0.135928, 0.136471, 0.134767,
#      0.132554, 0.133083, 0.131421, 0.129779, 0.130297, 0.130818, 0.129184, 0.129700, 0.128080, 0.128591,
#      0.126480, 0.126985, 0.125399, 0.125900, 0.124327, 0.122774, 0.121240, 0.119726, 0.118230, 0.118702,
#      0.117220, 0.115295, 0.115755, 0.114309, 0.114766, 0.113332, 0.111917, 0.112364, 0.110960, 0.109138,
#      0.109574, 0.108205, 0.106429, 0.105099, 0.105519, 0.105940, 0.104617, 0.105035, 0.103723, 0.102427,
#      0.101148, 0.099884, 0.098636, 0.097404, 0.096188, 0.094986, 0.093799, 0.092628, 0.091471, 0.091836,
#      0.090689, 0.089556, 0.088437, 0.087333, 0.087681, 0.086586, 0.085164, 0.085505, 0.084436, 0.083382,
#      0.082340, 0.080988, 0.081312, 0.080296, 0.078977, 0.077991, 0.078302, 0.077017, 0.076054, 0.074806,
#      0.073577, 0.072658, 0.071465, 0.071751, 0.070854, 0.069691, 0.068820, 0.069095, 0.067961, 0.067112,
#      0.066010, 0.065185, 0.064115, 0.063062, 0.062026, 0.061251, 0.060486, 0.059493, 0.058750, 0.057785,
#      0.058016, 0.057063, 0.056126, 0.055425, 0.054515, 0.053834, 0.052950, 0.052289, 0.051430, 0.050586,
#      0.049755, 0.049133, 0.048326, 0.047723, 0.046939, 0.046168, 0.045410, 0.044843, 0.044107, 0.043382,
#      0.042670, 0.042841, 0.042137, 0.041445, 0.040765, 0.040095, 0.039437, 0.038789, 0.038152, 0.037676,
#      0.037057, 0.036449, 0.035850 );

    for($i=0;$i<@ep-1;$i++){
	if ($ep[$i]<=$e && $e<$ep[$i+1]) {
	    return $qe[$i]+($e-$ep[$i])/($ep[$i+1]-$ep[$i])*($qe[$i+1]-$qe[$i]);
	}
    }
    return 0.;

}
