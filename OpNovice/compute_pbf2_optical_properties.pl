#!/usr/bin/perl

# Define PbF2 transparency for a set of wavelengths as measured by PADME Hungarian group

$sample_size = 3.; # Thickness of sample in cm

@wl = (
      250.0384, 250.0377, 250.0371, 250.0365, 250.5035, 250.9706, 250.9700, 251.4370, 
      251.4364, 251.4358, 251.9028, 251.9022, 251.9016, 252.3686, 252.3680, 252.8351, 
      252.8345, 252.8338, 253.3009, 253.3003, 253.2996, 253.2990, 253.7661, 253.7654, 
      253.7648, 254.2319, 254.2313, 254.2306, 254.2300, 254.2294, 254.2288, 254.6959, 
      254.6952, 254.6946, 254.6940, 254.6934, 254.6928, 254.6921, 254.6915, 255.1586, 
      255.1580, 255.1574, 255.1567, 255.1561, 255.1555, 255.1549, 255.6219, 255.6213, 
      255.6207, 255.6201, 255.6195, 255.6189, 255.6182, 255.6176, 255.6170, 256.0841, 
      256.0834, 256.0828, 256.0822, 256.0816, 256.5486, 256.5480, 256.5474, 256.5468, 
      256.5462, 256.5456, 257.0126, 257.0120, 257.0114, 257.0108, 257.0102, 257.4772, 
      257.4766, 257.4760, 257.4753, 257.4747, 257.4741, 257.4735, 257.9405, 257.9399, 
      257.9393, 257.9387, 257.9381, 257.9375, 257.9368, 257.9362, 257.9356, 257.9350, 
      257.9344, 257.9338, 257.9332, 258.4002, 258.3996, 258.3990, 258.3984, 258.3977, 
      258.3971, 258.3965, 258.3959, 258.3953, 258.3947, 258.3941, 258.8611, 258.8605, 
      258.8599, 258.8593, 258.8586, 258.8580, 258.8574, 258.8568, 258.8562, 259.3232, 
      259.3226, 259.3220, 259.3214, 259.3208, 259.3202, 259.7872, 259.7866, 259.7860, 
      259.7853, 259.7847, 260.2518, 260.2512, 260.2505, 260.2499, 260.2493, 260.2487, 
      260.7157, 260.7151, 260.7145, 260.7139, 260.7133, 260.7127, 260.7120, 260.7114, 
      260.7108, 260.7102, 260.7096, 261.1766, 261.1760, 261.1754, 261.1748, 261.1742, 
      261.1736, 261.1729, 261.1723, 261.6394, 261.6388, 261.6381, 261.6375, 261.6369, 
      261.6363, 261.6357, 261.6351, 261.6345, 261.6338, 261.6332, 261.6326, 262.0996, 
      262.0990, 262.0984, 262.0978, 262.0972, 262.0966, 262.0960, 262.5630, 262.5624, 
      262.5618, 262.5612, 262.5605, 262.5599, 262.5593, 262.5587, 262.5581, 263.0251, 
      263.0245, 263.0239, 263.0233, 263.0227, 263.4897, 263.4891, 263.4885, 263.4879, 
      263.4873, 263.9543, 263.9537, 263.9531, 264.4201, 264.4195, 264.4189, 264.4183, 
      264.4176, 264.4170, 264.4164, 264.4158, 264.8828, 264.8822, 264.8816, 264.8810, 
      264.8804, 264.8798, 265.3468, 265.3462, 265.3456, 265.3450, 265.3443, 265.3437, 
      265.3431, 265.3425, 265.3419, 265.8089, 265.8083, 265.8077, 265.8071, 266.2741, 
      266.2735, 266.2729, 266.7399, 266.7393, 266.7387, 267.2057, 267.2051, 267.2045, 
      267.2039, 267.2033, 267.6703, 267.6697, 267.6691, 267.6685, 267.6679, 267.6673, 
      268.1343, 268.1337, 268.1331, 268.1325, 268.1318, 268.1312, 268.1306, 268.5976, 
      268.5970, 268.5964, 268.5958, 268.5952, 268.5946, 269.0616, 269.0610, 269.0604, 
      269.0598, 269.0591, 269.0585, 269.5256, 269.5250, 269.5244, 269.5237, 269.5231, 
      269.9902, 269.9895, 270.4566, 270.4560, 270.4554, 270.9224, 270.9218, 271.3888, 
      271.3882, 271.3876, 271.3870, 271.3864, 271.3857, 271.8528, 271.8522, 271.8516, 
      271.8509, 272.3180, 272.3174, 272.3167, 272.3161, 272.3155, 272.3149, 272.7819, 
      272.7813, 273.2484, 273.2478, 273.7148, 273.7142, 274.1812, 274.1806, 274.1800, 
      274.6470, 274.6464, 274.6458, 275.1128, 275.1122, 275.1116, 275.1110, 275.1104, 
      275.5774, 275.5768, 275.5762, 275.5756, 276.0426, 276.0420, 276.0414, 276.0408, 
      276.5078, 276.5072, 276.9742, 276.9736, 277.4407, 277.9077, 277.9071, 277.9065, 
      278.3735, 278.3729, 278.8399, 278.8393, 278.8387, 279.3057, 279.3051, 279.3045, 
      279.7716, 279.7710, 280.2380, 280.2374, 280.7044, 280.7038, 281.1708, 281.1702, 
      281.6373, 281.6366, 281.6360, 282.1031, 282.1025, 282.5695, 282.5689, 282.5683, 
      283.0353, 283.5023, 283.5017, 283.9688, 284.4358, 284.4352, 284.9022, 284.9016, 
      284.9010, 285.3680, 285.3674, 285.3668, 285.8338, 285.8332, 286.3003, 286.2997, 
      286.7667, 287.2337, 287.7008, 288.1678, 288.1672, 288.6343, 289.1013, 289.1007, 
      289.1001, 289.5671, 290.0341, 290.5012, 290.9682, 290.9676, 291.4346, 291.9017, 
      291.9011, 292.3681, 292.3675, 292.8345, 292.8339, 293.3010, 293.3003, 293.7674, 
      294.2344, 294.7021, 295.1691, 295.6361, 295.6355, 296.1026, 296.1020, 296.5690, 
      297.0360, 297.5031, 297.9701, 298.4372, 298.9042, 298.9036, 299.3706, 299.8377, 
      300.3047, 300.3041, 300.7711, 301.2382, 301.7052, 302.1723, 302.6393, 303.1063, 
      303.5734, 304.0404, 304.5074, 304.9745, 305.4415, 305.9086, 306.3756, 306.3750, 
      306.8420, 307.3091, 307.3084, 307.7755, 308.2431, 308.7108, 309.1784, 309.1778, 
      309.6455, 309.6449, 310.1125, 310.5796, 311.0466, 311.0460, 311.0454, 311.0448, 
      311.5124, 311.9801, 312.4477, 312.9148, 313.3824, 313.8495, 314.3165, 314.7835, 
      315.2506, 315.7182, 315.7176, 316.1847, 316.6517, 317.1187, 317.5858, 318.0528, 
      318.5199, 318.9875, 319.4545, 319.9216, 320.3886, 320.8557, 321.3233, 321.7904, 
      322.2574, 322.7251, 323.1921, 323.6591, 324.1262, 324.5932, 325.0602, 325.5273, 
      325.9949, 326.4620, 326.9296, 327.3967, 327.8637, 328.3308, 328.7978, 329.2654, 
      329.7325, 330.2001, 330.6672, 331.1348, 331.6019, 332.0689, 332.5366, 333.0036, 
      333.4706, 333.9377, 334.4053, 334.8724, 335.3394, 335.8065, 336.2741, 336.7412, 
      337.2082, 337.6752, 338.1423, 338.6099, 339.0776, 339.5446, 340.0123, 340.4793, 
      340.9463, 341.4140, 341.8810, 342.3481, 342.8157, 343.2834, 343.7504, 344.2181, 
      344.6851, 345.1522, 345.6192, 346.0869, 346.5539, 347.0215, 347.4886, 347.9562, 
      348.4233, 348.8903, 349.3580, 349.8250, 350.2921, 350.7597, 351.2274, 351.6944, 
      352.1621, 352.6291, 353.0961, 353.5638, 354.0308, 354.4979, 354.9655, 355.4326, 
      355.9002, 356.3673, 356.8349, 357.3026, 357.7702, 358.2373, 358.7043, 359.1719, 
      359.6390, 360.1066, 360.5743, 361.0413, 361.5084, 361.9760, 362.4431, 362.9107, 
      363.3777, 363.8454, 364.3125, 364.7801, 365.2471, 365.7142, 366.1818, 366.6495, 
      367.1165, 367.5842, 368.0518, 368.5189, 368.9865, 369.4536, 369.9212, 370.3889, 
      370.8559, 371.3236, 371.7906, 372.2577, 372.7253, 373.1923, 373.6600, 374.1277, 
      374.5947, 375.0623, 375.5294, 375.9970, 376.4647, 376.9317, 377.3994, 377.8670, 
      378.3341, 378.8017, 379.2688, 379.7364, 380.2035, 380.6711, 381.1382, 381.6058, 
      382.0729, 382.5405, 383.0075, 383.4752, 383.9429, 384.4105, 384.8782, 385.3452, 
      385.8129, 386.2799, 386.7469, 387.2146, 387.6823, 388.1493, 388.6169, 389.0846, 
      389.5523, 390.0193, 390.4869, 390.9546, 391.4223, 391.8893, 392.3569, 392.8240, 
      393.2916, 393.7587, 394.2263, 394.6940, 395.1610, 395.6287, 396.0957, 396.5634, 
      397.0310, 397.4987, 397.9663, 398.4340, 398.9010, 399.3687, 399.8357, 400.3034, 
      400.7704, 401.2381, 401.2375, 401.7051, 402.1728, 402.6404, 403.1081, 403.5757, 
      404.0428, 404.5104, 404.9781, 405.4457, 405.9128, 406.3804, 406.8474, 407.3151, 
      407.7828, 408.2504, 408.7181, 409.1851, 409.6528, 410.1198, 410.5875, 411.0545, 
      411.5222, 411.9898, 412.4575, 412.9251, 413.3922, 413.8598, 414.3274, 414.7945, 
      415.2622, 415.7298, 416.1975, 416.6651, 417.1322, 417.5998, 417.5992, 418.0668, 
      418.5345, 419.0021, 419.4698, 419.9375, 420.4045, 420.8722, 421.3398, 421.8075, 
      422.2751, 422.7422, 423.2098, 423.6775, 424.1445, 424.6122, 425.0798, 425.5475, 
      426.0145, 426.4822, 426.9492, 427.4169, 427.8845, 428.3515, 428.8192, 429.2869, 
      429.7545, 430.2222, 430.6898, 431.1575, 431.6245, 432.0922, 432.5592, 433.0269, 
      433.4945, 433.9622, 434.4298, 434.8975, 435.3645, 435.8322, 436.2992, 436.7668, 
      437.2345, 437.7022, 438.1698, 438.6375, 439.1051, 439.5722, 440.0398, 440.5075, 
      440.9751, 441.4422, 441.9098, 442.3775, 442.8445, 443.3122, 443.7798, 444.2475, 
      444.7151, 445.1828, 445.6504, 446.1175, 446.5851, 447.0528, 447.5204, 447.9875, 
      448.4551, 448.9222, 449.3898, 449.8575, 450.3251, 450.7928, 451.2604, 451.7281, 
      452.1957, 452.6634, 453.1304, 453.5981, 454.0651, 454.5328, 455.0005, 455.4681, 
      455.9357, 456.4034, 456.8711, 457.3387, 457.8057, 458.2734, 458.7405, 459.2081, 
      459.6758, 460.1434, 460.6111, 461.0781, 461.5458, 462.0134, 462.4811, 462.9487, 
      463.4164, 463.8834, 464.3511, 464.8187, 465.2864, 465.7534, 466.2211, 466.6887, 
      467.1564, 467.6240, 468.0917, 468.5593, 469.0264, 469.4940, 469.9617, 470.4293, 
      470.8970, 471.3646, 471.8323, 472.2993, 472.7670, 473.2340, 473.7017, 474.1693, 
      474.6370, 475.1046, 475.5723, 476.0400, 476.5076, 476.9753, 477.4429, 477.9106, 
      478.3776, 478.8453, 479.3123, 479.7800, 480.2476, 480.7153, 481.1829, 481.6506, 
      482.1176, 482.5853, 483.0529, 483.5206, 483.9882, 484.4559, 484.9235, 485.3912, 
      485.8589, 486.3265, 486.7942, 487.2612, 487.7289, 488.1965, 488.6648, 489.1324, 
      489.1330, 489.6007, 490.0690, 490.5366, 491.0043, 491.4719, 491.9396, 492.4072, 
      492.8749, 493.3419, 493.8096, 494.2772, 494.7449, 495.2125, 495.6802, 496.1479, 
      496.6149, 497.0825, 497.5496, 498.0172, 498.4849, 498.9525, 499.4202, 499.8879, 
      500.3555, 500.8232, 501.2908, 501.7585, 502.2261, 502.6932, 503.1608, 503.6279, 
      504.0955, 504.5632, 505.0308, 505.4985, 505.9661, 506.4338, 506.9014, 507.3691, 
      507.8367, 508.3044, 508.7714, 509.2391, 509.7067, 510.1744, 510.6420, 511.1097, 
      511.5774, 512.0450, 512.5127, 512.9797, 513.4474, 513.9150, 514.3821, 514.8497, 
      515.3174, 515.7850, 516.2527, 516.7203, 517.1880, 517.6556, 518.1233, 518.5909, 
      519.0586, 519.5256, 519.9933, 520.4603, 520.9280, 521.3956, 521.8633, 522.3309, 
      522.7986, 523.2662, 523.7339, 524.2015, 524.6692, 525.1363, 525.6039, 526.0716, 
      526.5392, 527.0069, 527.4745, 527.9422, 528.4098, 528.8775, 529.3451, 529.8128, 
      530.2804, 530.7481, 531.2157, 531.6828, 532.1504, 532.6175, 533.0851, 533.5528, 
      534.0204, 534.4881, 534.9557, 535.4234, 535.8911, 536.3587, 536.8264, 537.2940, 
      537.7617, 538.2293, 538.6970, 539.1646, 539.6317, 540.0993, 540.5664, 541.0340, 
      541.5017, 541.9693, 542.4370, 542.9046, 543.3723, 543.8399, 544.3076, 544.7753, 
      545.2429, 545.7106, 546.1782, 546.6452, 547.1129, 547.5806, 548.0482, 548.5159, 
      548.9835, 549.4512, 549.9188, 550.3865, 550.8541, 551.3218, 551.7894, 552.2571, 
      552.7247, 553.1924, 553.6601, 554.1271, 554.5948, 555.0624, 555.5294, 555.9971, 
      556.4648, 556.9324, 557.4001, 557.8677, 558.3354, 558.8030, 559.2707, 559.7383, 
      560.2060, 560.6736, 561.1413, 561.6090, 562.0766, 562.5436, 563.0113, 563.4783, 
      563.9460, 564.4136, 564.8813, 565.3489, 565.8166, 566.2843, 566.7519, 567.2196, 
      567.6872, 568.1549, 568.6225, 569.0902, 569.5572, 570.0249, 570.4925, 570.9602, 
      571.4278, 571.8955, 572.3632, 572.8308, 573.2985, 573.7661, 574.2338, 574.7014, 
      575.1691, 575.6367, 576.1044, 576.5720, 577.0391, 577.5067, 577.9738, 578.4414, 
      578.9091, 579.3767, 579.8444, 580.3120, 580.7797, 581.2473, 581.7150, 582.1826, 
      582.6503, 583.1180, 583.5856, 584.0533, 584.5209, 584.9886, 585.4562, 585.9233, 
      586.3909, 586.8586, 587.3262, 587.7933, 588.2609, 588.7286, 589.1962, 589.6639, 
      590.1315, 590.5992, 591.0669, 591.5345, 592.0022, 592.4698, 592.9375, 593.4051, 
      593.8728, 594.3404, 594.8081, 595.2751, 595.7428, 596.2104, 596.6781, 597.1457, 
      597.6134, 598.0810, 598.5487, 599.0163, 599.4840, 599.9517, 600.4193, 600.8870, 
      601.3546, 601.8223, 602.2899, 602.7576, 603.2252, 603.6929, 604.1605, 604.6282, 
      605.0952, 605.5629, 606.0299, 606.4976, 606.9652, 607.4329, 607.9005, 608.3682, 
      608.8359, 609.3035, 609.7712, 610.2388, 610.7065, 611.1741, 611.6418, 612.1094, 
      612.5771, 613.0447, 613.5124, 613.9800, 614.4477, 614.9153, 615.3830, 615.8507, 
      616.3177, 616.7853, 617.2530, 617.7207, 618.1883, 618.6560, 619.1236, 619.5913, 
      620.0589, 620.5266, 620.9942, 621.4619, 621.9295, 622.3972, 622.8649, 623.3325, 
      623.8002, 624.2678, 624.7355, 625.2031, 625.6708, 626.1384, 626.6055, 627.0731, 
      627.5402, 628.0078, 628.4755, 628.9431, 629.4108, 629.8784, 630.3461, 630.8137, 
      631.2814, 631.7491, 632.2167, 632.6843, 633.1520, 633.6197, 634.0873, 634.5550, 
      635.0226, 635.4903, 635.9579, 636.4256, 636.8932, 637.3609, 637.8285, 638.2962, 
      638.7632, 639.2309, 639.6979, 640.1656, 640.6332, 641.1009, 641.5686, 642.0362, 
      642.5039, 642.9715, 643.4392, 643.9068, 644.3745, 644.8421, 645.3098, 645.7774, 
      646.2451, 646.7128, 647.1804, 647.6481, 648.1157, 648.5833, 649.0510, 649.5187, 
      649.9863, 650.4540, 650.9210, 651.3887, 651.8563, 652.3240, 652.7916, 653.2593, 
      653.7269, 654.1946, 654.6622, 655.1299, 655.5976, 656.0652, 656.5329, 657.0005, 
      657.4682, 657.9358, 658.4035, 658.8711, 659.3388, 659.8064, 660.2741, 660.7418, 
      661.2094, 661.6771, 662.1447, 662.6124, 663.0800, 663.5471, 664.0147, 664.4818, 
      664.9494, 665.4171, 665.8847, 666.3524, 666.8200, 667.2877, 667.7553, 668.2230, 
      668.6906, 669.1583, 669.6259, 670.0936, 670.5612, 671.0289, 671.4966, 671.9642, 
      672.4319, 672.8995, 673.3672, 673.8348, 674.3025, 674.7701, 675.2378, 675.7055, 
      676.1731, 676.6408, 677.1084, 677.5761, 678.0431, 678.5108, 678.9778, 679.4455, 
      679.9131, 680.3808, 680.8484, 681.3161, 681.7837, 682.2514, 682.7190, 683.1867, 
      683.6543, 684.1220, 684.5897, 685.0573, 685.5249, 685.9926, 686.4603, 686.9279, 
      687.3956, 687.8632, 688.3309, 688.7985, 689.2662, 689.7338, 690.2015, 690.6691, 
      691.1368, 691.6045, 692.0715, 692.5391, 693.0068, 693.4745, 693.9421, 694.4098, 
      694.8774, 695.3451, 695.8127, 696.2804, 696.7480, 697.2157, 697.6833, 698.1510, 
      698.6187, 699.0863, 699.5540, 700.0216, 700.4893, 700.9569, 701.4246, 701.8922, 
      702.3599, 702.8275, 703.2952, 703.7628, 704.2305, 704.6982, 705.1658, 705.6335, 
      706.1011, 706.5688, 707.0364, 707.5041, 707.9717, 708.4388, 708.9064, 709.3735, 
      709.8411, 710.3088, 710.7764, 711.2441, 711.7117, 712.1794, 712.6470, 713.1147, 
      713.5824, 714.0500, 714.5177, 714.9853, 715.4530, 715.9206, 716.3883, 716.8559, 
      717.3236, 717.7912, 718.2589, 718.7265, 719.1942, 719.6618, 720.1295, 720.5972, 
      721.0648, 721.5325, 722.0001, 722.4678, 722.9354, 723.4031, 723.8707, 724.3378, 
      724.8054, 725.2731, 725.7407, 726.2084, 726.6760, 727.1437, 727.6113, 728.0790, 
      728.5460, 729.0137, 729.4814, 729.9490, 730.4167, 730.8843, 731.3520, 731.8196, 
      732.2873, 732.7549, 733.2226, 733.6902, 734.1579, 734.6255, 735.0932, 735.5608, 
      736.0285, 736.4962, 736.9638, 737.4315, 737.8991, 738.3668, 738.8344, 739.3021, 
      739.7697, 740.2374, 740.7051, 741.1727, 741.6404, 742.1080, 742.5757, 743.0433, 
      743.5110, 743.9786, 744.4463, 744.9139, 745.3816, 745.8492, 746.3169, 746.7845, 
      747.2522, 747.7198, 748.1875, 748.6552, 749.1228, 749.5899, 750.0575, 750.5252, 
      750.9928, 751.4605, 751.9281, 752.3958, 752.8634, 753.3311, 753.7987, 754.2664, 
      754.7340, 755.2017, 755.6694, 756.1370, 756.6047, 757.0723, 757.5400, 758.0076, 
      758.4753, 758.9429, 759.4106, 759.8782, 760.3459, 760.8135, 761.2812, 761.7489, 
      762.2165, 762.6842, 763.1512, 763.6182, 764.0853, 764.5523 );
$nwl = @wl;

@tr = (
       0.1314,  0.2628,  0.3942,  0.5256,  0.6570,  0.7884,  0.9198,  1.0513, 
       1.1826,  1.3141,  1.4455,  1.5769,  1.7083,  1.8397,  1.9711,  2.1025, 
       2.2339,  2.3653,  2.4967,  2.6281,  2.7595,  2.8909,  3.0223,  3.1538, 
       3.2851,  3.4166,  3.5480,  3.6794,  3.8108,  3.9422,  4.0736,  4.2050, 
       4.3364,  4.4678,  4.5992,  4.7306,  4.8620,  4.9934,  5.1248,  5.2562, 
       5.3876,  5.5191,  5.6505,  5.7819,  5.9133,  6.0447,  6.1761,  6.3075, 
       6.4389,  6.5703,  6.7017,  6.8331,  6.9645,  7.0959,  7.2273,  7.3587, 
       7.4901,  7.6216,  7.7530,  7.8844,  8.0158,  8.1472,  8.2786,  8.4100, 
       8.5414,  8.6728,  8.8042,  8.9356,  9.0670,  9.1984,  9.3298,  9.4612, 
       9.5926,  9.7241,  9.8554,  9.9869, 10.1183, 10.2497, 10.3811, 10.5125, 
      10.6439, 10.7753, 10.9067, 11.0381, 11.1695, 11.3009, 11.4323, 11.5637, 
      11.6951, 11.8265, 11.9579, 12.0894, 12.2208, 12.3522, 12.4836, 12.6150, 
      12.7464, 12.8778, 13.0092, 13.1406, 13.2720, 13.4034, 13.5348, 13.6662, 
      13.7976, 13.9290, 14.0604, 14.1919, 14.3232, 14.4547, 14.5861, 14.7175, 
      14.8489, 14.9803, 15.1117, 15.2431, 15.3745, 15.5059, 15.6373, 15.7687, 
      15.9001, 16.0315, 16.1629, 16.2944, 16.4258, 16.5572, 16.6886, 16.8200, 
      16.9514, 17.0828, 17.2142, 17.3456, 17.4770, 17.6084, 17.7398, 17.8712, 
      18.0026, 18.1340, 18.2654, 18.3969, 18.5282, 18.6597, 18.7910, 18.9225, 
      19.0539, 19.1853, 19.3167, 19.4481, 19.5795, 19.7109, 19.8423, 19.9737, 
      20.1051, 20.2365, 20.3679, 20.4993, 20.6307, 20.7622, 20.8936, 21.0250, 
      21.1564, 21.2878, 21.4192, 21.5506, 21.6820, 21.8134, 21.9448, 22.0762, 
      22.2076, 22.3390, 22.4704, 22.6018, 22.7332, 22.8647, 22.9961, 23.1275, 
      23.2589, 23.3903, 23.5217, 23.6531, 23.7845, 23.9159, 24.0473, 24.1787, 
      24.3101, 24.4415, 24.5729, 24.7043, 24.8357, 24.9672, 25.0985, 25.2300, 
      25.3614, 25.4928, 25.6242, 25.7556, 25.8870, 26.0184, 26.1498, 26.2812, 
      26.4126, 26.5440, 26.6754, 26.8068, 26.9382, 27.0696, 27.2010, 27.3325, 
      27.4639, 27.5953, 27.7267, 27.8581, 27.9895, 28.1209, 28.2523, 28.3837, 
      28.5151, 28.6465, 28.7779, 28.9093, 29.0407, 29.1721, 29.3036, 29.4350, 
      29.5664, 29.6978, 29.8292, 29.9606, 30.0920, 30.2234, 30.3548, 30.4862, 
      30.6176, 30.7490, 30.8804, 31.0118, 31.1432, 31.2746, 31.4060, 31.5374, 
      31.6689, 31.8003, 31.9317, 32.0631, 32.1945, 32.3259, 32.4573, 32.5887, 
      32.7201, 32.8515, 32.9829, 33.1143, 33.2457, 33.3771, 33.5085, 33.6399, 
      33.7713, 33.9028, 34.0342, 34.1656, 34.2970, 34.4284, 34.5598, 34.6912, 
      34.8226, 34.9540, 35.0854, 35.2168, 35.3482, 35.4796, 35.6110, 35.7424, 
      35.8738, 36.0053, 36.1367, 36.2681, 36.3995, 36.5309, 36.6623, 36.7937, 
      36.9251, 37.0565, 37.1879, 37.3193, 37.4507, 37.5821, 37.7135, 37.8449, 
      37.9763, 38.1078, 38.2392, 38.3706, 38.5020, 38.6334, 38.7648, 38.8962, 
      39.0276, 39.1590, 39.2904, 39.4218, 39.5532, 39.6846, 39.8160, 39.9474, 
      40.0788, 40.2103, 40.3417, 40.4731, 40.6045, 40.7359, 40.8673, 40.9987, 
      41.1301, 41.2615, 41.3929, 41.5243, 41.6557, 41.7871, 41.9185, 42.0499, 
      42.1813, 42.3127, 42.4442, 42.5755, 42.7070, 42.8384, 42.9698, 43.1012, 
      43.2326, 43.3640, 43.4954, 43.6268, 43.7582, 43.8896, 44.0210, 44.1524, 
      44.2838, 44.4152, 44.5466, 44.6780, 44.8095, 44.9409, 45.0723, 45.2037, 
      45.3351, 45.4665, 45.5979, 45.7293, 45.8607, 45.9921, 46.1235, 46.2549, 
      46.3863, 46.5177, 46.6491, 46.7805, 46.9120, 47.0434, 47.1748, 47.3062, 
      47.4376, 47.5690, 47.7004, 47.8318, 47.9632, 48.0946, 48.2260, 48.3574, 
      48.4888, 48.6202, 48.7516, 48.8830, 49.0144, 49.1459, 49.2773, 49.4087, 
      49.5401, 49.5401, 49.6715, 49.8029, 49.9343, 50.0657, 50.1971, 50.3285, 
      50.4599, 50.5913, 50.7227, 50.8541, 50.9856, 51.1170, 51.2484, 51.3798, 
      51.5112, 51.6426, 51.7740, 51.9054, 52.0368, 52.1682, 52.2996, 52.4310, 
      52.5624, 52.6938, 52.8252, 52.9566, 53.0880, 53.2195, 53.3508, 53.4823, 
      53.6137, 53.7451, 53.8765, 54.0079, 54.0079, 54.0079, 54.0079, 54.1393, 
      54.1393, 54.2707, 54.2707, 54.4021, 54.5335, 54.6649, 54.7963, 54.9277, 
      54.9277, 54.9277, 54.9277, 55.0591, 55.0591, 55.1905, 55.3219, 55.4534, 
      55.5848, 55.5848, 55.7162, 55.8476, 55.9790, 56.1104, 56.2418, 56.3732, 
      56.5046, 56.5046, 56.6360, 56.7674, 56.8988, 57.0302, 57.0302, 57.1616, 
      57.2930, 57.2930, 57.4244, 57.5558, 57.6872, 57.8187, 57.9501, 58.0815, 
      58.0815, 58.2129, 58.2129, 58.3443, 58.4757, 58.6071, 58.7385, 58.7385, 
      58.8699, 58.8699, 59.0013, 59.0013, 59.1327, 59.2641, 59.2641, 59.3955, 
      59.5269, 59.6583, 59.6583, 59.7897, 59.9212, 60.0526, 60.0526, 60.1840, 
      60.3154, 60.4468, 60.5782, 60.5782, 60.5782, 60.7096, 60.7096, 60.8410, 
      60.9724, 60.9724, 61.1038, 61.2352, 61.2352, 61.2352, 61.3666, 61.3666, 
      61.4980, 61.6294, 61.7608, 61.7608, 61.8922, 61.8922, 62.0237, 62.0237, 
      62.1551, 62.2865, 62.2865, 62.4179, 62.5493, 62.5493, 62.5493, 62.6807, 
      62.6807, 62.8121, 62.9435, 62.9435, 63.0749, 63.2063, 63.2063, 63.3377, 
      63.3377, 63.4691, 63.4691, 63.4691, 63.4691, 63.6005, 63.7319, 63.7319, 
      63.8633, 63.8633, 63.8633, 63.9947, 64.1261, 64.1261, 64.2576, 64.2576, 
      64.3890, 64.3890, 64.5204, 64.5204, 64.6518, 64.7832, 64.7832, 64.7832, 
      64.9146, 64.9146, 64.9146, 65.0460, 65.0460, 65.1774, 65.1774, 65.1774, 
      65.3088, 65.3088, 65.4402, 65.5716, 65.5716, 65.7030, 65.7030, 65.7030, 
      65.8344, 65.8344, 65.9658, 65.9658, 65.9658, 66.0972, 66.0972, 66.0972, 
      66.2287, 66.2287, 66.3601, 66.3601, 66.4915, 66.4915, 66.6229, 66.6229, 
      66.7543, 66.7543, 66.8857, 66.8857, 66.8857, 66.8857, 66.8857, 67.0171, 
      67.0171, 67.1485, 67.2799, 67.2799, 67.2799, 67.4113, 67.4113, 67.4113, 
      67.4113, 67.5427, 67.5427, 67.5427, 67.5427, 67.6741, 67.6741, 67.8055, 
      67.8055, 67.9369, 67.9369, 67.9369, 68.0683, 68.0683, 68.1997, 68.1997, 
      68.1997, 68.1997, 68.1997, 68.1997, 68.3311, 68.3311, 68.4625, 68.4625, 
      68.5940, 68.5940, 68.7254, 68.7254, 68.7254, 68.7254, 68.7254, 68.7254, 
      68.8568, 68.8568, 68.8568, 68.8568, 68.9882, 68.9882, 69.1196, 69.1196, 
      69.1196, 69.1196, 69.1196, 69.2510, 69.2510, 69.3824, 69.3824, 69.5138, 
      69.5138, 69.5138, 69.5138, 69.5138, 69.6452, 69.6452, 69.6452, 69.7766, 
      69.7766, 69.7766, 69.7766, 69.7766, 69.9080, 69.9080, 70.0394, 70.0394, 
      70.0394, 70.0394, 70.0394, 70.0394, 70.1708, 70.1708, 70.1708, 70.1708, 
      70.1708, 70.3022, 70.3022, 70.3022, 70.4336, 70.4336, 70.4336, 70.4336, 
      70.5650, 70.5650, 70.6964, 70.6964, 70.6964, 70.8279, 70.8279, 70.8279, 
      70.8279, 70.8279, 70.8279, 70.8279, 70.9593, 70.9593, 71.0907, 71.0907, 
      71.0907, 71.0907, 71.0907, 71.0907, 71.2221, 71.2221, 71.3535, 71.3535, 
      71.3535, 71.3535, 71.3535, 71.3535, 71.3535, 71.4849, 71.4849, 71.4849, 
      71.4849, 71.6163, 71.6163, 71.6163, 71.7477, 71.7477, 71.7477, 71.7477, 
      71.7477, 71.7477, 71.7477, 71.8791, 71.8791, 71.8791, 71.8791, 72.0105, 
      72.0105, 72.1419, 72.1419, 72.1419, 72.1419, 72.1419, 72.1419, 72.1419, 
      72.1419, 72.1419, 72.2733, 72.2733, 72.4047, 72.4047, 72.4047, 72.4047, 
      72.4047, 72.4047, 72.4047, 72.4047, 72.5361, 72.5361, 72.6675, 72.6675, 
      72.6675, 72.6675, 72.6675, 72.7990, 72.7990, 72.7990, 72.7990, 72.7990, 
      72.7990, 72.9304, 72.9304, 72.9304, 72.9304, 73.0618, 73.0618, 73.0618, 
      73.0618, 73.0618, 73.0618, 73.0618, 73.1932, 73.1932, 73.1932, 73.1932, 
      73.1932, 73.1932, 73.1932, 73.3246, 73.3246, 73.4560, 73.4560, 73.4560, 
      73.4560, 73.4560, 73.4560, 73.4560, 73.4560, 73.4560, 73.4560, 73.4560, 
      73.5874, 73.5874, 73.7188, 73.7188, 73.7188, 73.7188, 73.7188, 73.7188, 
      73.8502, 73.8502, 73.8502, 73.8502, 73.8502, 73.8502, 73.8502, 73.8502, 
      73.8502, 73.8502, 73.8502, 73.9816, 73.9816, 73.9816, 73.8502, 73.8502, 
      73.7188, 73.7188, 73.5874, 73.5874, 73.5874, 73.5874, 73.5874, 73.5874, 
      73.5874, 73.7188, 73.7188, 73.7188, 73.7188, 73.7188, 73.7188, 73.7188, 
      73.8502, 73.8502, 73.9816, 73.9816, 73.9816, 73.9816, 73.9816, 73.9816, 
      73.9816, 73.9816, 73.9816, 73.9816, 73.9816, 74.1130, 74.1130, 74.2444, 
      74.2444, 74.2444, 74.2444, 74.2444, 74.2444, 74.2444, 74.2444, 74.2444, 
      74.2444, 74.2444, 74.3758, 74.3758, 74.3758, 74.3758, 74.3758, 74.3758, 
      74.3758, 74.3758, 74.3758, 74.5072, 74.5072, 74.5072, 74.6386, 74.6386, 
      74.6386, 74.6386, 74.6386, 74.6386, 74.6386, 74.6386, 74.6386, 74.6386, 
      74.6386, 74.7700, 74.7700, 74.9014, 74.9014, 74.9014, 74.9014, 74.9014, 
      74.9014, 74.9014, 74.9014, 74.9014, 74.9014, 75.0328, 75.0328, 75.0328, 
      75.0328, 75.0328, 75.0328, 75.0328, 75.0328, 75.0328, 75.0328, 75.0328, 
      75.0328, 75.0328, 75.0328, 75.1643, 75.1643, 75.2957, 75.2957, 75.2957, 
      75.2957, 75.2957, 75.2957, 75.2957, 75.2957, 75.2957, 75.2957, 75.2957, 
      75.2957, 75.2957, 75.2957, 75.2957, 75.4271, 75.4271, 75.5585, 75.5585, 
      75.5585, 75.5585, 75.5585, 75.5585, 75.5585, 75.5585, 75.5585, 75.5585, 
      75.5585, 75.5585, 75.5585, 75.6899, 75.6899, 75.6899, 75.6899, 75.6899, 
      75.6899, 75.6899, 75.6899, 75.6899, 75.6899, 75.6899, 75.6899, 75.6899, 
      75.6899, 75.6899, 75.6899, 75.8213, 75.8213, 75.8213, 75.9527, 75.9527, 
      75.9527, 75.9527, 75.9527, 75.9527, 75.9527, 75.9527, 75.9527, 75.9527, 
      75.9527, 75.9527, 75.9527, 75.9527, 75.9527, 76.0841, 76.0841, 76.2155, 
      76.2155, 76.2155, 76.2155, 76.2155, 76.2155, 76.2155, 76.2155, 76.2155, 
      76.2155, 76.2155, 76.2155, 76.2155, 76.3469, 76.3469, 76.3469, 76.3469, 
      76.3469, 76.3469, 76.3469, 76.3469, 76.3469, 76.3469, 76.3469, 76.3469, 
      76.3469, 76.3469, 76.3469, 76.3469, 76.4783, 76.4783, 76.6097, 76.6097, 
      76.6097, 76.6097, 76.6097, 76.6097, 76.6097, 76.6097, 76.6097, 76.6097, 
      76.6097, 76.6097, 76.6097, 76.6097, 76.6097, 76.6097, 76.6097, 76.7411, 
      76.7411, 76.7411, 76.7411, 76.8725, 76.8725, 76.8725, 76.8725, 76.8725, 
      76.8725, 76.8725, 76.8725, 76.8725, 76.8725, 76.8725, 76.8725, 76.8725, 
      76.8725, 76.8725, 76.8725, 77.0039, 77.0039, 77.0039, 77.0039, 77.0039, 
      77.0039, 77.0039, 77.0039, 77.0039, 77.0039, 77.0039, 77.0039, 77.0039, 
      77.0039, 77.0039, 77.0039, 77.0039, 77.0039, 77.0039, 77.0039, 77.0039, 
      77.1354, 77.1354, 77.2668, 77.2668, 77.2668, 77.2668, 77.2668, 77.2668, 
      77.2668, 77.2668, 77.2668, 77.2668, 77.2668, 77.2668, 77.2668, 77.2668, 
      77.2668, 77.2668, 77.2668, 77.2668, 77.2668, 77.2668, 77.2668, 77.2668, 
      77.3982, 77.3982, 77.3982, 77.3982, 77.3982, 77.3982, 77.3982, 77.3982, 
      77.3982, 77.3982, 77.3982, 77.3982, 77.3982, 77.3982, 77.3982, 77.3982, 
      77.3982, 77.3982, 77.3982, 77.3982, 77.3982, 77.3982, 77.5296, 77.5296, 
      77.6610, 77.6610, 77.6610, 77.6610, 77.6610, 77.6610, 77.6610, 77.6610, 
      77.6610, 77.6610, 77.6610, 77.6610, 77.6610, 77.6610, 77.6610, 77.6610, 
      77.6610, 77.6610, 77.6610, 77.6610, 77.6610, 77.6610, 77.6610, 77.6610, 
      77.7924, 77.7924, 77.9238, 77.9238, 77.9238, 77.9238, 77.9238, 77.9238, 
      77.9238, 77.9238, 77.9238, 77.9238, 77.9238, 77.9238, 77.9238, 77.9238, 
      77.9238, 77.9238, 77.9238, 77.9238, 77.9238, 77.9238, 77.9238, 77.9238, 
      77.9238, 77.9238, 78.0552, 78.0552, 78.0552, 78.0552, 78.0552, 78.0552, 
      78.0552, 78.0552, 78.0552, 78.0552, 78.0552, 78.0552, 78.0552, 78.0552, 
      78.0552, 78.0552, 78.0552, 78.0552, 78.0552, 78.0552, 78.0552, 78.0552, 
      78.0552, 78.0552, 78.0552, 78.0552, 78.0552, 78.1866, 78.1866, 78.3180, 
      78.3180, 78.3180, 78.3180, 78.3180, 78.3180, 78.3180, 78.3180, 78.3180, 
      78.3180, 78.3180, 78.3180, 78.3180, 78.3180, 78.3180, 78.3180, 78.3180, 
      78.3180, 78.3180, 78.3180, 78.3180, 78.3180, 78.3180, 78.3180, 78.3180, 
      78.3180, 78.3180, 78.3180, 78.3180, 78.4494, 78.4494, 78.5808, 78.5808, 
      78.5808, 78.5808, 78.5808, 78.5808, 78.5808, 78.5808, 78.5808, 78.5808, 
      78.5808, 78.5808, 78.5808, 78.5808, 78.5808, 78.5808, 78.5808, 78.5808, 
      78.5808, 78.5808, 78.5808, 78.5808, 78.5808, 78.5808, 78.5808, 78.5808, 
      78.5808, 78.5808, 78.7122, 78.7122, 78.7122, 78.7122, 78.7122, 78.7122, 
      78.7122, 78.7122, 78.7122, 78.7122, 78.7122, 78.7122, 78.7122, 78.7122, 
      78.7122, 78.7122, 78.7122, 78.7122, 78.7122, 78.7122, 78.7122, 78.7122, 
      78.7122, 78.7122, 78.7122, 78.7122, 78.7122, 78.7122, 78.7122, 78.7122, 
      78.7122, 78.7122, 78.7122, 78.7122, 78.7122, 78.8436, 78.8436, 78.9750, 
      78.9750, 78.9750, 78.9750, 78.9750, 78.9750, 78.9750, 78.9750, 78.9750, 
      78.9750, 78.9750, 78.9750, 78.9750, 78.9750, 78.9750, 78.9750, 78.9750, 
      78.9750, 78.9750, 78.9750, 78.9750, 78.9750, 78.9750, 78.9750, 78.9750, 
      78.9750, 78.9750, 78.9750, 78.9750, 78.9750, 78.9750, 78.9750, 79.1064, 
      79.1064, 79.1064, 79.1064, 79.1064, 79.1064, 79.1064, 79.1064, 79.1064, 
      79.2378, 79.2378, 79.2378, 79.2378, 79.2378, 79.2378, 79.2378, 79.2378, 
      79.2378, 79.2378, 79.2378, 79.2378, 79.2378, 79.2378, 79.2378, 79.2378, 
      79.2378, 79.2378, 79.2378, 79.2378, 79.2378, 79.2378, 79.2378, 79.2378, 
      79.2378, 79.2378, 79.2378, 79.2378, 79.2378, 79.2378, 79.2378, 79.2378, 
      79.2378, 79.2378, 79.2378, 79.2378, 79.2378, 79.2378, 79.2378, 79.2378, 
      79.2378, 79.2378, 79.2378, 79.2378, 79.2378, 79.3692, 79.3692, 79.3692, 
      79.3692, 79.3692, 79.3692, 79.3692, 79.3692, 79.3692, 79.3692, 79.3692, 
      79.3692, 79.3692, 79.3692, 79.3692, 79.3692, 79.3692, 79.3692, 79.3692, 
      79.3692, 79.3692, 79.3692, 79.3692, 79.3692, 79.3692, 79.3692, 79.3692, 
      79.3692, 79.3692, 79.5006, 79.6321, 79.7635, 79.8949 );

# Define energy spectrum of interest
$emin = 1.6;
#$emax = 4.;
$emax = 4.2;
$nbin = 130;
$de = ($emax-$emin)/$nbin;
#print "$emin $emax $nbin $de\n";
@gammaE = ();
for ($i=0;$i<$nbin+1;$i++) {
    #printf "%d\t%f\n",$i,$emin+$i*$de;
    $gammaE[$i] = $emin+$i*$de;
    #printf "%f\n",$gammaE[$i];
}

# Compute refractive index
for ($i=0;$i<$nbin+1;$i++) {
    $e = $gammaE[$i];
    $l = 1.23986/$e;
    $l2 = $l*$l;
    $ref_idx[$i] = sqrt(1.+0.66959342*$l2/($l2-1.218778E-7)+1.3086319*$l2/($l2-0.029393234)+0.01670641*$l2/($l2-0.079104448)+2007.8865*$l2/($l2-634690.5617));
    #printf "%5.3f   %7.3f   %6.4f\n",$e,$l,$ref_idx[$i];
    #printf "%6.4f, ",$n;
}

# Compute absorption length
for ($i=0;$i<$nbin+1;$i++) {
    $e = $gammaE[$i];
    $l = 1239.86/$e;
    # Find bin corresponding to wl
    $transp = 0.;
    for($j=0;$j<$nwl-1;$j++){
	if ($wl[$j]<=$l && $l<$wl[$j+1]) {
	    $transp = ($tr[$j]+($l-$wl[$j])/($wl[$j+1]-$wl[$j])*($tr[$j+1]-$tr[$j]))/100.;
	    #printf "$tr[$j] $tr[$j+1] $transp\n";
	    last;
	}
    }
    if ($transp > 0. ) {
	$abs_len[$i] = -$sample_size/log($transp);
    } else {
	$abs_len[$i] = 0.;
    }

}

printf "\n  G4double pbf2PhotonEnergy[] = {"; 
for($i=0;$i<=$nbin;$i++){
    if ($i%10 == 0) { printf "\n      "; }
    printf "%4.2f*eV",$gammaE[$i];
    if ($i != $nbin) { printf ", "; }
}
printf " };\n";

printf "\n  G4double pbf2RefractiveIndex[] = {"; 
for($i=0;$i<=$nbin;$i++){
    if ($i%10 == 0) { printf "\n      "; }
    printf "%6.4f",$ref_idx[$i];
    if ($i != $nbin) { printf ", "; }
}
printf " };\n";

printf "\n  G4double pbf2Absorption[] = {"; 
for($i=0;$i<=$nbin;$i++){
    if ($i%10 == 0) { printf "\n      "; }
    printf "%5.2f*cm",$abs_len[$i];
    if ($i != $nbin) { printf ", "; }
}
printf " };\n";
